{"version":3,"sources":["../../../../src/server/plugins/homepage/index.js"],"names":[],"mappings":"AAAA;;AAEA,IAAM,iBAAiB,SAAjB,cAAiB,CAAC,MAAD,EAAS,OAAT,EAAkB,IAAlB,EAA2B;;AAEhD,SAAO,KAAP,CAAa;AACX,YAAQ,KADG;AAEX,UAAM,eAFK;AAGX,aAAS,iBAAC,GAAD,EAAM,KAAN,EAAgB;;AAEvB,aAAO,OAAP,CAAe,mBAAf,CAAmC,IAAI,MAAJ,CAAW,SAA9C,EAAyD,IAAzD,CAA8D,UAAC,QAAD,EAAc;;AAE1E,eAAO,OAAP,CAAe,YAAf,CAA4B,GAA5B,EAAiC,IAAjC,CAAsC,UAAC,IAAD,EAAU;;AAE9C,cAAM,YAAY,OAAO,MAAP,CAAc,EAAd,EAAkB,EAAE,UAAU,QAAZ,EAAlB,EAA0C,EAAE,MAAM,IAAR,EAA1C,CAAlB;;AAEA,iBAAO,MAAP,CAAc,SAAd,EAAyB,SAAzB,EAAoC;AAClC,4BAAgB;AACd,4BAAc;AADA;AADkB,WAApC,EAIG,UAAC,KAAD,EAAQ,MAAR,EAAmB;AACpB,gBAAI,KAAJ,EAAW;AACT,qBAAO,MAAM,KAAN,CAAP;AACD;;AAED,gBAAM,cAAc;AAClB,uBAAS,MADS;AAElB,wCAAwB,KAAK,SAAL,CAAe,SAAf,CAAxB;AAFkB,aAApB;;AAKA,mBAAO,MAAP,CAAc,eAAd,EAA+B,WAA/B,EAA4C,UAAC,KAAD,EAAQ,IAAR,EAAiB;AAC3D,kBAAI,KAAJ,EAAW;AACT,uBAAO,MAAM,KAAN,CAAP;AACD;AACD,oBAAM,IAAN;AACD,aALD;AAOD,WArBD;AAsBD,SA1BD,EA0BG,UAAC,KAAD;AAAA,iBAAW,MAAM,KAAN,CAAX;AAAA,SA1BH;AA2BD,OA7BD,EA6BG,UAAC,KAAD;AAAA,eAAW,MAAM,KAAN,CAAX;AAAA,OA7BH;AA8BD;AAnCU,GAAb;;AAsCA,SAAO,MAAP;AACD,CAzCD;;AA2CA,eAAe,UAAf,GAA4B;AAC1B,QAAM,UADoB;AAE1B,WAAS,OAFiB;AAG1B,gBAAc;AAHY,CAA5B;;AAMA,OAAO,OAAP,GAAiB,cAAjB","file":"index.js","sourcesContent":["'use strict';\n\nconst registerPlugin = (server, options, next) => {\n\n  server.route({\n    method: 'GET',\n    path: '/{shortCode?}',\n    handler: (req, reply) => {\n\n      server.methods.getShortcodeDetails(req.params.shortCode).then((location) => {\n\n        server.methods.getUserState(req).then((user) => {\n\n          const pageState = Object.assign({}, { location: location }, { user: user });\n\n          server.render('c2c-app', pageState, {\n            runtimeOptions: {\n              renderMethod: 'renderToString'\n            }\n          }, (error, output) => {\n            if (error) {\n              return reply(error);\n            }\n\n            const htmlContext = {\n              remount: output,\n              state: `window.C2CFYI=${JSON.stringify(pageState)};`\n            };\n\n            server.render('layout/layout', htmlContext, (error, html) => {\n              if (error) {\n                return reply(error);\n              }\n              reply(html);\n            })\n\n          });\n        }, (error) => reply(error));\n      }, (error) => reply(error));\n    }\n  });\n\n  return next();\n};\n\nregisterPlugin.attributes = {\n  name: 'homepage',\n  version: '1.0.0',\n  dependencies: []\n};\n\nmodule.exports = registerPlugin;\n"]}